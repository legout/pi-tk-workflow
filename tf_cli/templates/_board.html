<!-- Board fragment with header stats and columns - rendered as partial for Datastar updates -->
<div id="board">
    <div class="board-header">
        <h2>Kanban Board</h2>
        <div id="board-stats" class="board-stats">
            <span>Ready: {{ counts.ready }}</span>
            <span>Blocked: {{ counts.blocked }}</span>
            <span>In Progress: {{ counts.in_progress }}</span>
            <span>Closed: {{ counts.closed }}</span>
        </div>
        <button class="btn" data-on:click="@get('/api/refresh')">
            ðŸ”„ Refresh
        </button>
    </div>

    <div class="board">
    <div class="column">
        <div class="column-header">
            <span>Ready</span>
            <span class="column-count">{{ columns.ready|length }}</span>
        </div>
        <div class="column-body">
            {% for ticket in columns.ready %}
            <div class="ticket-card" data-on:click="@get('/ticket/{{ ticket.id }}')">
                <div class="ticket-header">
                    <span class="ticket-id">{{ ticket.id }}</span>
                    {% if ticket.priority is not none %}
                    <span class="ticket-priority priority-p{{ ticket.priority }}">P{{ ticket.priority }}</span>
                    {% else %}
                    <span class="ticket-priority priority-pnone">â€”</span>
                    {% endif %}
                </div>
                <div class="ticket-title">{{ ticket.title or '(no title)' }}</div>
                {% if ticket.assignee %}
                <div class="ticket-meta">ðŸ‘¤ {{ ticket.assignee }}</div>
                {% endif %}
            </div>
            {% else %}
            <div class="empty-state">No tickets ready</div>
            {% endfor %}
        </div>
    </div>
    
    <div class="column">
        <div class="column-header">
            <span>Blocked</span>
            <span class="column-count">{{ columns.blocked|length }}</span>
        </div>
        <div class="column-body">
            {% for ticket in columns.blocked %}
            <div class="ticket-card" data-on:click="@get('/ticket/{{ ticket.id }}')">
                <div class="ticket-header">
                    <span class="ticket-id">{{ ticket.id }}</span>
                    {% if ticket.priority is not none %}
                    <span class="ticket-priority priority-p{{ ticket.priority }}">P{{ ticket.priority }}</span>
                    {% else %}
                    <span class="ticket-priority priority-pnone">â€”</span>
                    {% endif %}
                </div>
                <div class="ticket-title">{{ ticket.title or '(no title)' }}</div>
                {% if ticket.blocking_deps %}
                <div class="ticket-meta">â›” {{ ticket.blocking_deps|join(', ') }}</div>
                {% endif %}
            </div>
            {% else %}
            <div class="empty-state">No blocked tickets</div>
            {% endfor %}
        </div>
    </div>
    
    <div class="column">
        <div class="column-header">
            <span>In Progress</span>
            <span class="column-count">{{ columns.in_progress|length }}</span>
        </div>
        <div class="column-body">
            {% for ticket in columns.in_progress %}
            <div class="ticket-card" data-on:click="@get('/ticket/{{ ticket.id }}')">
                <div class="ticket-header">
                    <span class="ticket-id">{{ ticket.id }}</span>
                    {% if ticket.priority is not none %}
                    <span class="ticket-priority priority-p{{ ticket.priority }}">P{{ ticket.priority }}</span>
                    {% else %}
                    <span class="ticket-priority priority-pnone">â€”</span>
                    {% endif %}
                </div>
                <div class="ticket-title">{{ ticket.title or '(no title)' }}</div>
                {% if ticket.assignee %}
                <div class="ticket-meta">ðŸ‘¤ {{ ticket.assignee }}</div>
                {% endif %}
            </div>
            {% else %}
            <div class="empty-state">No tickets in progress</div>
            {% endfor %}
        </div>
    </div>
    
    <div class="column">
        <div class="column-header">
            <span>Closed</span>
            <span class="column-count">{{ columns.closed|length }}</span>
        </div>
        <div class="column-body">
            {% for ticket in columns.closed %}
            <div class="ticket-card" data-on:click="@get('/ticket/{{ ticket.id }}')">
                <div class="ticket-header">
                    <span class="ticket-id">{{ ticket.id }}</span>
                    {% if ticket.priority is not none %}
                    <span class="ticket-priority priority-p{{ ticket.priority }}">P{{ ticket.priority }}</span>
                    {% else %}
                    <span class="ticket-priority priority-pnone">â€”</span>
                    {% endif %}
                </div>
                <div class="ticket-title">{{ ticket.title or '(no title)' }}</div>
            </div>
            {% else %}
            <div class="empty-state">No closed tickets</div>
            {% endfor %}
        </div>
    </div>
</div>
</div>
